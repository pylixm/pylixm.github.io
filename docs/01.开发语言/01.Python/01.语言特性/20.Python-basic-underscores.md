---
title: Python åŒä¸‹åˆ’çº¿å’Œå•ä¸‹åˆ’çº¿çš„æ„ä¹‰æ€»ç»“
permalink: /pages/c80587/
tags:
  - Python
  - è¯­è¨€ç‰¹æ€§
createTime: 2023/09/08 17:36:02
---

> åŸæ–‡ï¼š https://towardsdatascience.com/whats-the-meaning-of-single-and-double-underscores-in-python-3d27d57d6bd1

åœ¨ Python ä¸­å‘½åå˜é‡å’Œå‡½æ•°æ—¶ï¼Œä½ æœ‰æ²¡æœ‰å¥½å¥‡è¿‡å•ä¸‹åˆ’çº¿å’ŒåŒä¸‹åˆ’çº¿çš„ä¸åŒå«ä¹‰ï¼Ÿ

æˆ‘æœ€è¿‘ç ”ç©¶äº†è¿™ä¸ªä¸»é¢˜ä»¥å¤ä¹ ä¸€äº›åŸºç¡€çŸ¥è¯†ï¼Œå¹¶å†³å®šå°†å…¶å†™ä¸‹æ¥ï¼Œå› ä¸ºæˆ‘ç¡®å®çŸ¥é“æœ‰ä¸€å¤©æˆ‘ä¼šå†æ¬¡éœ€è¦å®ƒã€‚

è¿™ç¯‡æ–‡ç« è¯¦ç»†ä»‹ç»äº†ä¸‹åˆ’çº¿çš„ä¸åŒä½¿ç”¨æ–¹å¼ã€‚å®ƒå°†æ¶µç›–ï¼š

- å•å‰å¯¼ä¸‹åˆ’çº¿ï¼š_foo
- å•ä¸ªå°¾éšä¸‹åˆ’çº¿ï¼šfoo_
- å•ä¸‹åˆ’çº¿ï¼š_
- åŒå‰å¯¼å’Œå°¾éšä¸‹åˆ’çº¿ï¼ˆç”¨äºå®šä¹‰dunder æ–¹æ³•ï¼‰ï¼š`__bar__`
- åŒå‰å¯¼ä¸‹åˆ’çº¿ï¼š__bar


äº†è§£æ¯ç§è¯­æ³•çš„å«ä¹‰ä»¥åŠä½•æ—¶åº”è¯¥ä½¿ç”¨å®ƒï¼Œå°†å¸®åŠ©æ‚¨åœ¨å¯è¯»æ€§å’Œæ•ˆç‡æ–¹é¢æé«˜ä»£ç è´¨é‡ã€‚

è¿™ä¹Ÿå°†å¸®åŠ©æ‚¨éµå®ˆæ ‡å‡†çš„å‘½åçº¦å®šã€‚

äº‹ä¸å®œè¿Ÿï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹ä¸€äº›å®é™…çš„ä¾‹å­ğŸ”

## 1 å•å‰å¯¼ä¸‹åˆ’çº¿ï¼š_foo

å˜é‡ã€å‡½æ•°æˆ–æ–¹æ³•åç§°å‰çš„å•ä¸ªå‰å¯¼ä¸‹åˆ’çº¿è¡¨ç¤ºè¿™äº›å¯¹è±¡åœ¨å†…éƒ¨ä½¿ç”¨ã€‚

è¿™æ›´åƒæ˜¯å¯¹ç¨‹åºå‘˜çš„è¯­æ³•æç¤ºï¼Œå¹¶ä¸æ˜¯ç”± Python è§£é‡Šå™¨å¼ºåˆ¶æ‰§è¡Œçš„ï¼Œè¿™æ„å‘³ç€è¿™äº›å¯¹è±¡ä»ç„¶å¯ä»¥ä»å¦ä¸€ä¸ªè„šæœ¬ä»¥ä¸€ç§æ–¹å¼è®¿é—®â€‹â€‹å¦ä¸€ç§æ–¹å¼ã€‚

ä½†æ˜¯ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹æ— æ³•è®¿é—®å…·æœ‰å‰å¯¼ä¸‹åˆ’çº¿çš„å˜é‡ã€‚

`module.py`è€ƒè™‘ä»¥ä¸‹å®šä¹‰ä¸¤ä¸ªå˜é‡çš„æ–‡ä»¶ã€‚

```python
# module.py

public_variable = 2
_private_variable = 1/2
```

å¦‚æœæ‚¨ä»è§£é‡Šå™¨æˆ–å…¶ä»–åœ°æ–¹ä½¿ç”¨é€šé…ç¬¦å¯¼å…¥ï¼ˆå°½ç®¡å¼ºçƒˆå»ºè®®ä¸è¦è¿™æ ·åšï¼‰ï¼Œæ‚¨ä¼šæ³¨æ„åˆ°å…·æœ‰å‰å¯¼ä¸‹åˆ’çº¿çš„å˜é‡åœ¨å‘½åç©ºé—´ä¸­ä¸å¯ç”¨ã€‚

```python
>>> from module import *

>>> public_variable
2

>>> _private_variable
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
<ipython-input-69-28da499e5a9b> in <module>
----> 1 _private_variable

NameError: name '_private_variable' is not defined
```

ä½†æ˜¯ï¼Œæ­£å¦‚æˆ‘ä»¬å‰é¢æ‰€è¯´ï¼Œ`_private_variable`å¦‚æœå¯¼å…¥æ¨¡å—å¹¶ç›´æ¥è°ƒç”¨å˜é‡åï¼Œä»ç„¶å¯ä»¥è®¿é—®ã€‚

```python
>>> import module

>>> module.public_variable
2

>>>module._private_variable
0.5
```

å•å‰å¯¼ä¸‹åˆ’çº¿é€šå¸¸åœ¨ç±»ä¸­ç”¨äºå®šä¹‰â€œå†…éƒ¨â€å±æ€§ã€‚æˆ‘åœ¨å†…éƒ¨å‘¨å›´åŠ ä¸Šäº†åŒå¼•å·ï¼Œå› ä¸ºåœ¨ Python ä¸­æ²¡æœ‰å†…éƒ¨å±æ€§è¿™æ ·çš„ä¸œè¥¿ã€‚å‰å¯¼ä¸‹åˆ’çº¿ä»ç„¶æ˜¯ä¸€ä¸ªç¬¦å·ï¼Œåº”è¯¥è¿™æ ·å¯¹å¾…ã€‚

å¦‚æœä½ æœ‰ä¸€äº›ä¸æ‰“ç®—ä»ç±»å¤–éƒ¨è®¿é—®çš„å±æ€§ï¼Œä»…ä»…æ˜¯å› ä¸ºå®ƒä»¬ä»…åœ¨å†…éƒ¨ç”¨äºä¸­é—´è®¡ç®—ï¼Œä½ å¯ä»¥è€ƒè™‘ä¸ºå®ƒä»¬æ·»åŠ ä¸€ä¸ªå‰å¯¼ä¸‹åˆ’çº¿â€”â€”è¿™å°†ä½œä¸ºä¸€ä¸ª**æç¤º**ã€‚

è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªä¾‹å­ï¼šè€ƒè™‘ä¸€ä¸ª Employee ç±»ï¼Œå®ƒå®šä¹‰äº†ä¸€ä¸ª_seniorityå±æ€§ï¼Œé™¤å…¶ä»–å¤–ï¼Œè¯¥å±æ€§æ˜¯è®¡ç®—è–ªé…¬åŒ…æ‰€éœ€çš„ã€‚

```python
import datetime

class Employee:
     def __init__(self, first_name, last_name, start_date):
         self.first_name = first_name
         self.last_name = last_name
         self.start_date = start_date
         self._seniority = self._get_seniority(start_date)

     def _get_seniority(self):
         today_date = datetime.datetime.today().date()
         seniority = (today_date - start_date).days
         return seniority
     
    def compute_compensation_package(self):
         # use self._seniority here.

        
first_name = "John"
last_name = "Doe"
start_date = datetime.date(2021, 12, 1)
employee = Employee(first_name, last_name, start_date)

>>> employee._seniority
53
```

å¦‚æ‚¨æ‰€è§ï¼Œ_seniorityå¯ä»¥ä»ç±»çš„å¤–éƒ¨è®¿é—®è¯¥å±æ€§ã€‚


## 2 å•å°¾éšä¸‹åˆ’çº¿ï¼šfoo_

åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ‚¨æƒ³è¦ä½¿ç”¨çš„å˜é‡åå®é™…ä¸Šæ˜¯ Python ä¸­çš„ä¿ç•™å…³é”®å­—ï¼Œä¾‹å¦‚class, def, type,objectç­‰ã€‚

ä¸ºé¿å…è¿™ç§å†²çªï¼Œæ‚¨å¯ä»¥æ·»åŠ å°¾éšä¸‹åˆ’çº¿ä½œä¸ºå‘½åçº¦å®šã€‚


```python
class_ = "A"
```


## 3 å•ä¸‹åˆ’çº¿ï¼š_

åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ‚¨ä¼šçœ‹åˆ° python å¼€å‘äººå‘˜ä½¿ç”¨å•ä¸‹åˆ’çº¿ã€‚ä¸»è¦æœ‰ä¸‹è¾¹å‡ ç§ï¼š

### å®šä¹‰ä¸´æ—¶æˆ–æœªä½¿ç”¨çš„å˜é‡ã€‚

**ç¤ºä¾‹ #1**

å¦‚æœæ‚¨ä¸ä½¿ç”¨ for å¾ªç¯çš„è¿è¡Œç´¢å¼•ï¼Œæ‚¨å¯ä»¥è½»æ¾åœ°å°†å…¶æ›¿æ¢ä¸ºå•ä¸ªä¸‹åˆ’çº¿ã€‚

```python
for _ in range(100):
   do_some_work()
```

**ç¤ºä¾‹ #2**

å¦‚æœä½ çš„å‡½æ•°è¿”å›ä¸€ä¸ªåŒ…å«äº”ä¸ªå…ƒç´ çš„å…ƒç»„ï¼Œä½†ä½ åªéœ€è¦ä½¿ç”¨å…¶ä¸­çš„ä¸¤ä¸ªï¼ˆä¾‹å¦‚ç¬¬ä¸€ä¸ªå’Œç¬¬å››ä¸ªï¼‰ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸‹åˆ’çº¿æ¥å‘½åå‰©ä¸‹çš„ä¸‰ä¸ªã€‚

```python
cpu, _, _, memory, _ = extract_laptop_specs(laptop)
```

### python äº¤äº’å¼è§£é‡Šå™¨ä¸­æœ€åä¸€æ¬¡è¯„ä¼°çš„ç»“æœå­˜å‚¨åœ¨â€œ_â€ä¸­

```python
In [1]: a = 2

In [2]: a
Out[2]: 2

In [3]: _
Out[3]: 2
```

### ç”¨ä½œæ•°å­—åˆ†ç»„çš„è§†è§‰åˆ†éš”ç¬¦

æ ¹æ®[PEP 515](https://www.python.org/dev/peps/pep-0515/)ï¼Œç°åœ¨å¯ä»¥å°†ä¸‹åˆ’çº¿æ·»åŠ åˆ°æ•°å­—æ–‡å­—ä¸­ä»¥æé«˜é•¿æ•°å­—çš„å¯è¯»æ€§ã€‚

ä¸‹é¢æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼Œæ‚¨å¯ä»¥å°†åè¿›åˆ¶æ•°æŒ‰åƒä½è¿›è¡Œåˆ†ç»„ã€‚

```python
In [2]: 1_000
Out[2]: 1000
  
In [3]: 1_000_000
Out[3]: 1000000

In [4]: 1_000_000_000
Out[4]: 1000000000
```

## 4 åŒå‰å¯¼å’Œå°¾éšä¸‹åˆ’çº¿ï¼š__foo__

åŒå‰å¯¼å’Œå°¾éƒ¨ä¸‹åˆ’çº¿ç”¨äºå®šä¹‰ç‰¹æ®Šçš„é€šç”¨ç±»æ–¹æ³•ï¼Œç§°ä¸ºdunder æ–¹æ³•ï¼ˆ D ouble Under score methodsçš„ç¼©å†™ï¼‰ã€‚

Dunder æ–¹æ³•æ˜¯æ‚¨ä»ç„¶å¯ä»¥è¦†ç›–çš„ä¿ç•™æ–¹æ³•ã€‚å®ƒä»¬å…·æœ‰ç‰¹æ®Šçš„è¡Œä¸ºå¹¶ä¸”è¢«ç§°ä¸ºä¸åŒçš„ã€‚ä¾‹å¦‚ï¼š

- `__init__` ç”¨ä½œç±»çš„æ„é€ å‡½æ•°
- `__call__` ç”¨äºä½¿å¯¹è±¡å¯è°ƒç”¨
- `__str__` ç”¨äºå®šä¹‰å½“æˆ‘ä»¬å°†å¯¹è±¡ä¼ é€’ç»™å‡½æ•°æ—¶å±å¹•ä¸Šæ‰“å°çš„å†…å®¹printã€‚

å¦‚æ‚¨æ‰€è§ï¼ŒPython å¼•å…¥äº†è¿™ç§å‘½åçº¦å®šæ¥åŒºåˆ†æ¨¡å—çš„æ ¸å¿ƒæ–¹æ³•å’Œç”¨æˆ·å®šä¹‰çš„æ–¹æ³•ã€‚

å¦‚æœæ‚¨æƒ³äº†è§£æ›´å¤šæœ‰å…³ dunder æ–¹æ³•çš„ä¿¡æ¯ï¼Œå¯ä»¥æŸ¥çœ‹[æ­¤é“¾æ¥](https://www.section.io/engineering-education/dunder-methods-python/)ã€‚



## 5 åŒå‰å¯¼ä¸‹åˆ’çº¿ï¼š__bar

åŒå‰å¯¼ä¸‹åˆ’çº¿é€šå¸¸ç”¨äºåç§°ä¿®é¥°ã€‚

åç§°é‡æ•´æ˜¯è§£é‡Šå™¨æ›´æ”¹å±æ€§åç§°ä»¥é¿å…å­ç±»ä¸­çš„å‘½åå†²çªçš„è¿‡ç¨‹ã€‚

è®©æˆ‘ä»¬çœ‹ä¸‹é¢çš„ç±»æ¥è¯´æ˜ï¼š

```python
class Car:
    def __init__(self):
        self.color = "red"
        self._speed = 70
        self.__brand = "bmw"
        
car = Car()
```

carç°åœ¨è®©æˆ‘ä»¬ä½¿ç”¨å†…ç½®æ–¹æ³•æ£€æŸ¥å¯¹è±¡çš„å±æ€§dirã€‚

```python
>>> print(dir(car))

['_Car__brand', '__class__', '__delattr__', '__dict__', '__dir__', '__doc__', 
 '__eq__', '__format__', '__ge__', '__getattribute__', '__gt__', '__hash__',
 '__init__', '__init_subclass__', '__le__', '__lt__', '__module__', '__ne__', 
 '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', 
 '__sizeof__', '__str__', '__subclasshook__', '__weakref__', '_speed', 'color']
```

æˆ‘ä»¬æ³¨æ„åˆ°colorå’Œ_speedå¯ç”¨ä½†ä¸å¯ç”¨__brandã€‚

ä½†æ˜¯ï¼Œæœ‰ä¸€ä¸ª`_Car__brand`å±æ€§ä»£æ›¿ã€‚è¿™å°±æ˜¯åç§°é‡æ•´ï¼šè§£é‡Šå™¨åœ¨å±æ€§å‰åŠ ä¸Šä¸€ä¸ªâ€œ_â€åŠ ä¸Šç±»åã€‚è¿™æ ·åšæ˜¯ä¸ºäº†é¿å…å±æ€§çš„å€¼__brandåœ¨å­ç±»ä¸­è¢«è¦†ç›–ã€‚

è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå­ç±»å¹¶å°è¯•è¦†ç›–ä»¥å‰çš„å±æ€§ï¼š

```python
class ExtendedCar(Car):
    def __init__(self):
        super(ExtendedCar, self).__init__()
        self.color = "green"
        self._speed = 80
        self.__brand = "audi"
        
extended_car = ExtendedCar()
```

ç°åœ¨è®©æˆ‘ä»¬æ£€æŸ¥å¯¹è±¡çš„å±æ€§extended_carï¼š

```python
>>> print(dir(extended_car))

['_Car__brand', '_ExtendedCar__brand', '__class__', '__delattr__', '__dict__', 
 '__dir__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__',
 '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__',
 '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__',
 '__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__',
 '__weakref__', '_speed', 'color']
```

å¦‚æˆ‘ä»¬æ‰€è§ï¼Œæ·»åŠ äº†ä¸€ä¸ªæ–°å±æ€§ï¼š`_ExtendedCar_brand`è€Œ`_Car_brand`æ¥è‡ªçˆ¶ç±»çš„ ä»ç„¶å­˜åœ¨ã€‚

å¦‚æœæˆ‘ä»¬å°è¯•è®¿é—®è¿™ä¸¤ä¸ªå±æ€§ï¼š

```python
>>> extended_car._Car__brand
'bmw'

>>> extended_car._ExtendedCar__brand
'audi'
```

æˆ‘ä»¬æ³¨æ„åˆ°å±æ€§çš„å€¼`__brand`ï¼ˆæ¥è‡ªçˆ¶ç±»ï¼‰æ²¡æœ‰è¢«è¦†ç›–ï¼Œå³ä½¿ExtendedCarç±»çš„å®šä¹‰ä¼šå»ºè®®è¿™æ ·åšã€‚

## èµ„æº

æˆ‘ä»æ¥ä¸çŸ¥é“å•ä¸‹åˆ’çº¿å’ŒåŒä¸‹åˆ’çº¿åœ¨è®¸å¤šä¸åŒçš„ä¸Šä¸‹æ–‡ä¸­ä¼šæœ‰åŒæ ·å¤šçš„å«ä¹‰ã€‚

äº†è§£å®ƒä»¬å¾ˆæœ‰è¶£ï¼Œå¹¶ä¸”ä¸€å¦‚æ—¢å¾€ï¼Œè¿™æ˜¯æˆ‘çš„èµ„æºåˆ—è¡¨ï¼Œä¾›æ‚¨æ·±å…¥ç ”ç©¶è¯¥ä¸»é¢˜ã€‚

- https://towardsdatascience.com/5-different-meanings-of-underscore-in-python-3fafa6cd0379
- https://www.python.org/dev/peps/pep-0515/
- https://www.python.org/dev/peps/pep-0008/
- ä¸€ç¯‡å…³äº Dunders çš„æ³•è¯­åšæ–‡ï¼šhttps ://he-arc.github.io/livre-python/dunders/index.html
- https://www.section.io/engineering-education/dunder-methods-python/