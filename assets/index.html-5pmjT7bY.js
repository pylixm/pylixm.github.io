import{_ as a,c as i,a as e,o as t}from"./app-DdES4ywf.js";const n={};function l(p,s){return t(),i("div",null,[...s[0]||(s[0]=[e(`<p>Salt，一种全新的基础设施管理方式，部署轻松，在几分钟内可运行起来，扩展性好，很容易管理上万台服务器，速度够快，服务器之间秒级通讯。</p><p>salt底层采用动态的连接总线, 使其可以用于编配, 远程执行, 配置管理等等。</p><p>官方文档：<a href="https://docs.saltstack.com/en/latest/" target="_blank" rel="noopener noreferrer">https://docs.saltstack.com/en/latest/</a></p><p>中文文档：<a href="http://docs.saltstack.cn/zh_CN/latest/" target="_blank" rel="noopener noreferrer">http://docs.saltstack.cn/zh_CN/latest/</a></p><p>中文社区：<a href="http://www.saltstack.cn/" target="_blank" rel="noopener noreferrer">http://www.saltstack.cn/</a></p><h3 id="_0x00-saltstack-安装" tabindex="-1"><a class="header-anchor" href="#_0x00-saltstack-安装"><span>0x00 saltstack 安装</span></a></h3><p>salt安装分为 master 安装和 minion 的安装。</p><p>centos6.6 为例(其他系统见官网：<a href="https://docs.saltstack.com/en/latest/topics/installation/index.html#platform-specific-installation-instructions" target="_blank" rel="noopener noreferrer">这里</a>)</p><h4 id="_1、开启epel" tabindex="-1"><a class="header-anchor" href="#_1、开启epel"><span>1、开启EPEL</span></a></h4><p>EPER源(EPEL 是yum的一个软件源，里面包含了许多基本源里没有的软件。)</p><p><del>rpm -Uvh http://ftp.linux.ncsu.edu/pub/epel/6/i386/epel-release-6-8.noarch.rpm </del></p><p>20160303 update:</p><p>rpm --import https://repo.saltstack.com/yum/redhat/6/x86_64/latest/SALTSTACK-GPG-KEY.pub</p><p>设置yum 源 <code>/etc/yum.repos.d/saltstack.repo</code></p><pre><code>[saltstack-repo]
name=SaltStack repo for RHEL/CentOS $releasever
baseurl=https://repo.saltstack.com/yum/redhat/$releasever/$basearch/latest
enabled=1
gpgcheck=1
gpgkey=https://repo.saltstack.com/yum/redhat/$releasever/$basearch/latest/SALTSTACK-GPG-KEY.pub
</code></pre><p>更新yum源</p><p>sudo yum clean expire-cache.</p><p>sudo yum update.</p><h4 id="_2、安装master和minion" tabindex="-1"><a class="header-anchor" href="#_2、安装master和minion"><span>2、安装master和minion</span></a></h4><p>Salt的master和minion包是分开的。机器只需要安装相应的包即可运行。通常情况下，会有一个master和多个minions</p><ul><li><p>在salt-master上，运行:</p><p><code>yum install salt-master</code></p></li><li><p>在salt-minion上，运行:</p><p><code>yum install salt-minion</code></p></li></ul><h3 id="_0x01-saltstack-配置" tabindex="-1"><a class="header-anchor" href="#_0x01-saltstack-配置"><span>0x01 saltstack 配置</span></a></h3><h4 id="_1-master配置" tabindex="-1"><a class="header-anchor" href="#_1-master配置"><span>1. master配置</span></a></h4><p>配置文件 <code>/etc/salt/master</code> ，master的相关配置在此修改，配置如下。</p><p><code>insterface: 192.168.33.10</code> 绑定master的通信 IP</p><h4 id="_2-minion配置" tabindex="-1"><a class="header-anchor" href="#_2-minion配置"><span>2. minion配置</span></a></h4><p>配置文件 <code>/etc/salt/minion</code> ，minion的配置文件位置同master。minion安装后需要修改配置如下：</p><p><code>master: 192.168.33.10</code> # 指定master的地址</p><h4 id="_3-master与minion认证" tabindex="-1"><a class="header-anchor" href="#_3-master与minion认证"><span>3. master与minion认证</span></a></h4><ul><li>启动master</li></ul><p><code>/etc/init.d/salt-master start</code></p><ul><li>启动minion</li></ul><p><code>/etc/init.d/salt-minion start</code></p><ul><li><p>当minion启动时，会向配置文件中配置的master发送自己的key，作为认证实用。key的取值，默认取第一个网卡的ip作为key。也可以在minion配置文件中，配置<code>id: minion的key </code></p></li><li><p>在master 执行 <code>salt-key -L</code> 查看链接此master的所有minion的key。执行 <code>salt-key -a minion的key</code> 来添加minion的认证。</p></li><li><p>执行 <code>salt 192.168.33.11 test.ping</code> 来测试minion的连通性。</p></li></ul><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">root@localhost salt</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"># salt-key -L</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Accepted</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Keys:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Denied</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Keys:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Unaccepted</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Keys:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">192.168.33.11</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Rejected</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Keys:</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">root@localhost salt</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"># salt-key -a 192.168.33.11</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">The</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> following</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> keys</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> are</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> going</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> to</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> be</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> accepted:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Unaccepted</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Keys:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">192.168.33.11</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Proceed?</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> [n/Y] y</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Key</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> for</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> minion</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 192.168.33.11</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> accepted.</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">root@localhost salt</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"># salt-key -L</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Accepted</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Keys:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">192.168.33.11</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Denied</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Keys:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Unaccepted</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Keys:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Rejected</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Keys:</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">root@localhost salt</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"># salt </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">192.168.33.11</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> test.ping </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">192.168.33.11:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    True</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_4-其他" tabindex="-1"><a class="header-anchor" href="#_4-其他"><span>4.其他</span></a></h4><p>1、默认的日志路径： /var/log/salt</p><p>2、有时使用<code>test.ping</code> 测试minion不通。很大可能是因为认证的问题，注意salt 的认证机制。</p><ul><li><p>启动master， master 会生成秘钥保存在 <code>pki</code> 目录中。</p></li><li><p>启动minion， minion 会生成秘钥也保存在 pki 目录中。</p></li><li><p>master 通过保存在pki中的秘钥做相关认证。</p></li></ul><p>所以，当秘钥发声变化的时候就ping 不通了。此时，可以尝试删除 pki 目录，重启重新认证。</p><h3 id="salt-博客推荐" tabindex="-1"><a class="header-anchor" href="#salt-博客推荐"><span>salt 博客推荐</span></a></h3><p>在学习salt时，收集到的比较靠谱的博客：</p><p><a href="http://www.xiaomastack.com/category/salt/" target="_blank" rel="noopener noreferrer">小马的博客salt系列</a></p><p><a href="http://www.shencan.net/index.php/category/%E8%87%AA%E5%8A%A8%E5%8C%96%E8%BF%90%E7%BB%B4/saltstack/" target="_blank" rel="noopener noreferrer">灿哥的Blog</a></p><h3 id="参考" tabindex="-1"><a class="header-anchor" href="#参考"><span>参考：</span></a></h3><p><a href="https://docs.saltstack.com/en/latest/" target="_blank" rel="noopener noreferrer">https://docs.saltstack.com/en/latest/</a></p>`,46)])])}const h=a(n,[["render",l]]),d=JSON.parse('{"path":"/pages/262ffa/","title":"SaltStack学习笔记1-salt安装配置","lang":"zh-CN","frontmatter":{"title":"SaltStack学习笔记1-salt安装配置","tags":["salt"],"permalink":"/pages/262ffa/","createTime":"2023/09/08 17:36:02","description":"Salt，一种全新的基础设施管理方式，部署轻松，在几分钟内可运行起来，扩展性好，很容易管理上万台服务器，速度够快，服务器之间秒级通讯。 salt底层采用动态的连接总线, 使其可以用于编配, 远程执行, 配置管理等等。 官方文档：https://docs.saltstack.com/en/latest/ 中文文档：http://docs.saltstac...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"SaltStack学习笔记1-salt安装配置\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-09-30T08:57:49.000Z\\",\\"author\\":[]}"],["meta",{"property":"og:url","content":"https://pylixm.top/pages/262ffa/"}],["meta",{"property":"og:site_name","content":"底层逻辑"}],["meta",{"property":"og:title","content":"SaltStack学习笔记1-salt安装配置"}],["meta",{"property":"og:description","content":"Salt，一种全新的基础设施管理方式，部署轻松，在几分钟内可运行起来，扩展性好，很容易管理上万台服务器，速度够快，服务器之间秒级通讯。 salt底层采用动态的连接总线, 使其可以用于编配, 远程执行, 配置管理等等。 官方文档：https://docs.saltstack.com/en/latest/ 中文文档：http://docs.saltstac..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-09-30T08:57:49.000Z"}],["meta",{"property":"article:tag","content":"salt"}],["meta",{"property":"article:modified_time","content":"2025-09-30T08:57:49.000Z"}]]},"readingTime":{"minutes":2.55,"words":766},"git":{"createdTime":1759222669000,"updatedTime":1759222669000,"contributors":[{"name":"pylixm","username":"pylixm","email":"pyli.xm@gmail.com","commits":1,"avatar":"https://avatars.githubusercontent.com/pylixm?v=4","url":"https://github.com/pylixm"}]},"autoDesc":true,"filePathRelative":"05.运维/21.salt/01.Salt-install.md","headers":[],"categoryList":[{"id":"8091bd","sort":5,"name":"运维"},{"id":"46d221","sort":21,"name":"salt"}]}');export{h as comp,d as data};
